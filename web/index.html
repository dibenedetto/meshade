<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>Numel AI Playground</title>

		<!-- SchemaGraph Theme & Styles (load first for CSS variables) -->
		<link rel="stylesheet" href="schemagraph/schemagraph-themes.css">
		<link rel="stylesheet" href="schemagraph/schemagraph-canvas.css">
		<link rel="stylesheet" href="schemagraph/schemagraph-ui.css">

		<!-- Numel App Styles (inherits SchemaGraph theme) -->
		<link rel="stylesheet" href="numel-app.css">
	</head>
	<body>
		<!-- Chat Panel -->
		<div class="numel-panel">
			<h1 class="numel-title">
				<span class="numel-brand">Numel AI</span> Playground
			</h1>

			<!-- Connection Config -->
			<div class="numel-config-section">
				<div class="numel-config-row">
					<label for="serverUrl">URL:</label>
					<input type="url" id="serverUrl" value="http://localhost:8000" placeholder="http://localhost:8000" />
				</div>
				<div class="numel-config-row">
					<label for="userId">User ID:</label>
					<input type="text" id="userId" placeholder="Optional User ID" />
				</div>
				<div class="numel-config-row">
					<label for="sessionId">Session ID:</label>
					<input type="text" id="sessionId" placeholder="Optional Session ID" />
				</div>
				<div class="numel-config-row">
					<label for="status">Status:</label>
					<div id="status" class="numel-status numel-status-idle">Not connected</div>
				</div>
			</div>

			<!-- Agent Config -->
			<div class="numel-config-section">
				<div class="numel-config-row">
					<label for="appAgentSelect">Agent:</label>
					<select id="appAgentSelect" disabled>
						<option value="-1"> - None - </option>
					</select>
				</div>
				<div class="numel-config-row">
					<label for="debugMessage">Debug:</label>
					<input type="checkbox" id="debugMessage" />
				</div>
			</div>

			<!-- Chat Container -->
			<div id="chatContainer" class="numel-chat-container"></div>

			<!-- Input Group -->
			<div class="numel-input-group">
				<input type="text" id="messageInput" placeholder="Type your message..." disabled>
				<button id="sendButton" class="numel-btn numel-btn-primary" disabled>Send</button>
				<button id="clearChatButton" class="numel-btn numel-btn-secondary">🗑️</button>
				<button id="connectButton" class="numel-btn numel-btn-accent">Connect</button>
			</div>

			<div id="loading" class="numel-loading">Loading NumelApp...</div>
		</div>

		<!-- Workflow Panel -->
		<div class="numel-workflow-panel" id="workflowPanel" style="display: none;">
			<div class="workflow-header">
				<h2 class="workflow-title">🔄 Workflows</h2>
				<button id="toggleWorkflowPanel" class="numel-btn numel-btn-secondary workflow-toggle">
					▼ Collapse
				</button>
			</div>

			<!-- Workflow Execution Status -->
			<div class="workflow-status-section">
				<div class="workflow-status-row">
					<label>Status:</label>
					<div id="workflowStatus" class="workflow-status workflow-status-idle">Idle</div>
				</div>
				<div class="workflow-status-row">
					<label>Message:</label>
					<div id="workflowMessage" class="workflow-message">No workflow running</div>
				</div>
				<div class="workflow-status-row">
					<label>Duration:</label>
					<div id="workflowDuration" class="workflow-duration">0s</div>
				</div>
			</div>

			<!-- Progress Bar -->
			<div class="workflow-progress-section">
				<div class="workflow-progress-label">
					<span>Progress:</span>
					<span id="workflowProgressText">0%</span>
				</div>
				<div class="workflow-progress-container">
					<div id="workflowProgressBar" class="workflow-progress-bar"></div>
				</div>
			</div>

			<!-- Workflow Controls -->
			<div class="workflow-controls">
				<button id="stopWorkflowBtn" class="numel-btn numel-btn-accent-red">
					⏹️ Stop
				</button>
				<button id="getWorkflowStatusBtn" class="numel-btn numel-btn-secondary">
					🔄 Status
				</button>
				<button id="refreshWorkflowBtn" class="numel-btn numel-btn-secondary">
					📋 List
				</button>
			</div>

			<!-- Workflow List -->
			<div class="workflow-list-section">
				<h3 class="workflow-list-title">Available Workflows</h3>
				<div id="workflowList" class="workflow-list">
					<div class="workflow-list-empty">Connect to see workflows</div>
				</div>
			</div>
		</div>

		<!-- SchemaGraph Canvas Panel -->
		<div class="numel-graph-panel">
			<!-- Hidden UI Elements (SchemaGraph requires these IDs) -->
			<div class="numel-hidden-elements">
				<div class="sg-error-banner" id="sg-errorBanner"></div>
				<div class="sg-node-types" id="sg-nodeTypes">
					<strong>Registered Node Types:</strong> 
					<span id="sg-nodeTypesList">None</span>
				</div>
				<div class="sg-schema-manager" style="display: none;">
					<div class="sg-schema-manager-title">📋 Registered Schemas:</div>
					<div id="sg-schemaList"></div>
				</div>

				<button id="sg-uploadSchemaBtn" class="sg-action-btn">📤 Upload Schema</button>
				<button id="sg-exportBtn" class="sg-action-btn">Export Graph</button>
				<button id="sg-importBtn" class="sg-action-btn">Import Graph</button>
				<button id="sg-exportConfigBtn" class="sg-action-btn">Export Config</button>
				<button id="sg-importConfigBtn" class="sg-action-btn">Import Config</button>

				<input type="file" id="sg-uploadSchemaFile" accept=".py" />
				<input type="file" id="sg-importFile" accept=".json" />
				<input type="file" id="sg-importConfigFile" accept=".json" />

				<button id="sg-textScalingToggle" class="sg-text-scaling-toggle">
					<span class="sg-text-scaling-icon">🔤</span>
					<span class="sg-text-scaling-label" id="sg-textScalingLabel">Fixed</span>
				</button>
			</div>

			<!-- Canvas Container -->
			<div class="sg-canvas-container">
				<canvas id="sg-main-canvas"></canvas>
				<div id="sg-contextMenu" class="sg-context-menu"></div>
				<input type="text" id="sg-nodeInput" class="sg-node-input-overlay" />

				<!-- Toolbar -->
				<div class="sg-zoom-indicator numel-toolbar">
					<div class="sg-status">
						Status: <span class="sg-status-value" id="sg-status">None</span>
					</div>
					<div class="sg-divider"></div>

					<!-- Voice Controls -->
					<div class="sg-voice-controls">
						<span style="font-size: 10px; color: var(--sg-text-tertiary); margin-right: 4px;">🎤 Voice:</span>
						<button id="sg-voiceStartBtn" class="sg-voice-btn">Start</button>
						<button id="sg-voiceStopBtn" class="sg-voice-btn" style="display: none;">Stop</button>
						<span id="sg-voiceStatus" class="sg-voice-status"></span>
					</div>
					<div class="sg-divider"></div>

					<!-- Analytics -->
					<button id="sg-analyticsToggleBtn" class="sg-action-btn">📊 Analytics</button>
					<div class="sg-divider"></div>

					<!-- Theme & Style -->
					<button id="sg-themeBtn" class="sg-theme-btn" title="Switch theme">🎨</button>
					<select id="sg-drawingStyleSelect" class="sg-drawing-style-select" title="Change drawing style">
						<option value="default">🎨 Default</option>
						<option value="minimal">✨ Minimal</option>
						<option value="blueprint">📐 Blueprint</option>
						<option value="neon">💫 Neon</option>
						<option value="organic">🌿 Organic</option>
						<option value="wireframe">📊 Wireframe</option>
					</select>
					<div class="sg-divider"></div>

					<!-- Layout -->
					<select id="sg-layoutSelect" class="sg-layout-select" title="Apply layout algorithm">
						<option value="">🔧 Layout...</option>
						<option value="hierarchical-vertical">Hierarchical (Vertical)</option>
						<option value="hierarchical-horizontal">Hierarchical (Horizontal)</option>
						<option value="force-directed">Force-Directed</option>
						<option value="grid">Grid</option>
						<option value="circular">Circular</option>
					</select>
					<button id="sg-centerViewBtn" class="sg-action-btn" title="Center view on graph">🎯 Center</button>
					<div class="sg-divider"></div>

					<!-- Zoom -->
					Zoom: <span class="sg-zoom-value" id="sg-zoomLevel">100%</span>
					<button id="sg-resetZoomBtn" class="sg-zoom-reset-btn" title="Reset zoom to 100%">⟲</button>
				</div>
			</div>
		</div>

		<!-- Footer -->
		<div class="numel-footer">
			&copy; 2025 - <a href="mailto:marco.dibenedetto@isti.cnr.it">Marco Di Benedetto</a>
		</div>

		<!-- Scripts -->
		<script type="text/javascript" src="dist/agui-client.bundle.js"></script>
		<script type="text/javascript" src="schemagraph/schemagraph.js"></script>
		<script type="text/javascript" src="schemagraph-workflow.js"></script>
		<script type="text/javascript" src="numel.js"></script>
		<script type="text/javascript" src="numel-app.js"></script>
	</body>
</html>
