{
	"info": {
		"name": "Customer Support Workflow",
		"version": "1.0.0",
		"author": "marco@numel.app",
		"description": "Automated customer support workflow with decision branches using index-based references"
	},
	"options": {},
	"nodes": [
		{
			"id": "start_1",
			"type": "start",
			"label": "Start",
			"initial_data": {
				"customer_query": "",
				"priority": "normal"
			}
		},
		{
			"id": "input_1",
			"type": "user_input",
			"label": "Get Customer Query",
			"prompt_text": "Please describe your issue:",
			"timeout": 300
		},
		{
			"id": "agent_1",
			"type": "agent",
			"label": "Analyze Query",
			"agent": 0,
			"input_mapping": {
				"query": "variables.customer_query"
			},
			"output_mapping": {
				"category": "$2.response.category",
				"sentiment": "$2.response.sentiment"
			}
		},
		{
			"id": "decision_1",
			"type": "decision",
			"label": "Route by Category",
			"condition_field": "category",
			"branches": {
				"technical": 4,
				"billing": 5,
				"general": 6
			}
		},
		{
			"id": "agent_tech",
			"type": "agent",
			"label": "Technical Support",
			"agent": 0,
			"input_mapping": {
				"query": "variables.customer_query",
				"category": "variables.category"
			}
		},
		{
			"id": "agent_billing",
			"type": "agent",
			"label": "Billing Support",
			"agent": 0,
			"input_mapping": {
				"query": "variables.customer_query",
				"category": "variables.category"
			}
		},
		{
			"id": "agent_general",
			"type": "agent",
			"label": "General Support",
			"agent": 0,
			"input_mapping": {
				"query": "variables.customer_query",
				"category": "variables.category"
			}
		},
		{
			"id": "merge_1",
			"type": "merge",
			"label": "Merge Responses",
			"strategy": "first",
			"wait_for": [4, 5, 6]
		},
		{
			"id": "transform_1",
			"type": "transform",
			"label": "Format Response",
			"transform_type": "python",
			"transform_script": "output = f\"Response: {input.get('merged', 'No response')}\\nCategory: {context.variables.get('category', 'unknown')}\"",
			"input_mapping": {
				"merged": "$7.merged"
			}
		},
		{
			"id": "end_1",
			"type": "end",
			"label": "End",
			"output_mapping": {
				"final_response": "variables.transform_output"
			}
		}
	],
	"edges": [
		{
			"source": 0,
			"target": 1,
			"label": "Initialize"
		},
		{
			"source": 1,
			"target": 2,
			"label": "Query received"
		},
		{
			"source": 2,
			"target": 3,
			"label": "Analyzed"
		},
		{
			"source": 3,
			"target": 4,
			"condition": {
				"type": "equals",
				"field": "category",
				"value": "technical"
			},
			"label": "Technical"
		},
		{
			"source": 3,
			"target": 5,
			"condition": {
				"type": "equals",
				"field": "category",
				"value": "billing"
			},
			"label": "Billing"
		},
		{
			"source": 3,
			"target": 6,
			"condition": {
				"type": "equals",
				"field": "category",
				"value": "general"
			},
			"label": "General"
		},
		{
			"source": 4,
			"target": 7,
			"label": "Tech response"
		},
		{
			"source": 5,
			"target": 7,
			"label": "Billing response"
		},
		{
			"source": 6,
			"target": 7,
			"label": "General response"
		},
		{
			"source": 7,
			"target": 8,
			"label": "Merged"
		},
		{
			"source": 8,
			"target": 9,
			"label": "Formatted"
		}
	],
	"variables": {
		"max_retries": 3,
		"timeout": 300
	}
}
